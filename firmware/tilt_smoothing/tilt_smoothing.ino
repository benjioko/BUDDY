#define stepPin 4
#define dirPin 3

const int dataLength = 299;
int deltaSteps[dataLength] = {
  -5, -15, -26, -34, -44, -52, -61, -69, -76, -84, -91, -97, -104, -109, -115, -120, -125, -129, -133, -137, -141, -144, -146, -149, -150, -152, -154, -154, -154, -156, -154, -154, -154, -152, -150, -149, -146, -144, -141, -137, -133, -129, -125, -120, -115, -109, -104, -97, -91, -84, -76, -69, -61, -52, -44, -34, -26, -15, -5, 5, 15, 24, 34, 42, 51, 59, 66, 74, 82, 88, 94, 100, 107, 111, 117, 122, 126, 130, 133, 138, 140, 142, 146, 147, 149, 150, 152, 152, 152, 152, 152, 152, 150, 149, 147, 146, 142, 140, 138, 133, 130, 126, 122, 117, 111, 107, 100, 94, 88, 82, 74, 66, 59, 51, 42, 34, 24, 15, 5, -7, -21, -35, -48, -60, -71, -83, -93, -104, -112, -121, -130, -137, -144, -151, -156, -162, -166, -171, -174, -177, -179, -181, -182, -183, -183, -182, -181, -179, -177, -174, -171, -166, -162, -156, -151, -144, -137, -130, -121, -112, -104, -93, -83, -71, -60, -48, -35, -21, -7, 11, 33, 54, 73, 91, 108, 125, 139, 153, 165, 178, 187, 196, 205, 211, 217, 221, 225, 228, 228, 228, 228, 225, 221, 217, 211, 205, 196, 187, 178, 165, 153, 139, 125, 108, 91, 73, 54, 33, 11, -20, -58, -93, -125, -156, -182, -207, -228, -248, -263, -278, -288, -296, -302, -304, -304, -302, -296, -288, -278, -263, -248, -228, -207, -182, -156, -125, -93, -58, -20, 20, 58, 93, 125, 156, 182, 207, 228, 248, 263, 278, 288, 296, 302, 304, 304, 302, 296, 288, 278, 263, 248, 228, 207, 182, 156, 125, 93, 58, 20, -78, -218, -338, -435, -511, -566, -598, -608, -598, -566, -511, -435, -338, -218, -78, 78, 218, 338, 435, 511, 566, 598, 608, 598, 566, 511, 435, 338, 218, 78
};
unsigned int delayTimes[dataLength] = {
  8320, 2780, 1603, 1223, 947, 801, 681, 604, 548, 495, 458, 429, 400, 382, 362, 346, 333, 323, 312, 304, 295, 288, 285, 279, 277, 274, 270, 270, 270, 267, 270, 270, 270, 273, 278, 279, 284, 289, 295, 303, 313, 323, 332, 347, 362, 381, 400, 429, 457, 496, 548, 602, 683, 801, 945, 1226, 1603, 2773, 8340, 8340, 2773, 1737, 1226, 990, 817, 706, 630, 563, 508, 472, 443, 417, 388, 375, 356, 340, 330, 320, 312, 302, 297, 292, 285, 283, 279, 278, 274, 273, 274, 274, 273, 274, 278, 279, 283, 285, 292, 297, 302, 312, 320, 330, 340, 356, 375, 388, 416, 443, 472, 508, 563, 630, 706, 817, 990, 1226, 1737, 2773, 8339, 5957, 1980, 1191, 868, 693, 587, 502, 447, 400, 372, 343, 320, 304, 288, 276, 267, 256, 251, 243, 239, 235, 232, 229, 229, 227, 227, 229, 230, 232, 235, 239, 243, 251, 257, 266, 276, 289, 303, 320, 344, 371, 400, 448, 501, 587, 694, 866, 1191, 1985, 5942, 3790, 1263, 770, 571, 458, 385, 333, 299, 271, 252, 234, 222, 212, 203, 197, 192, 188, 184, 182, 182, 182, 182, 185, 188, 192, 197, 202, 212, 222, 233, 252, 272, 299, 333, 386, 457, 571, 772, 1260, 3790, 2085, 717, 448, 333, 266, 229, 201, 182, 168, 158, 149, 144, 140, 137, 137, 137, 137, 140, 144, 149, 158, 168, 182, 201, 229, 266, 333, 448, 717, 2085, 2085, 717, 448, 333, 266, 229, 201, 182, 168, 158, 149, 144, 140, 137, 137, 137, 137, 140, 144, 149, 158, 168, 182, 201, 229, 266, 333, 448, 717, 2085, 534, 190, 123, 95, 81, 73, 69, 68, 69, 73, 81, 95, 123, 190, 534, 534, 190, 123, 95, 81, 73, 69, 68, 69, 73, 81, 95, 123, 190, 534
};



void setup() {
  pinMode(stepPin, OUTPUT);
  pinMode(dirPin, OUTPUT);
}

void loop() {
  for (int i = 0; i < dataLength; i++) {
    int direction = deltaSteps[i] >= 0 ? HIGH : LOW;
    digitalWrite(dirPin, direction);

    for (int j = 0; j < abs(deltaSteps[i]); j++) {
      digitalWrite(stepPin, HIGH);
      delayMicroseconds(delayTimes[i] / 2);
      digitalWrite(stepPin, LOW);
      delayMicroseconds(delayTimes[i] / 2);
    }
  }

  while (true); // Stop after completing motion
}
